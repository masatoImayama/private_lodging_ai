# マルチテナントRAGチャットボット コスト比較分析

## 前提条件
- **テナント数:** 100社
- **ドキュメント数:** 各社20件（総2,000件）
- **チャット頻度:** 各社30回/日（月間90,000回）
- **チャンク数:** 約10,000件（1ドキュメント≈5チャンク）
- **平均文書サイズ:** 5ページ、5,000文字

---

## パターンA: Gemini 1.5 Pro（高品質・高コスト）

### 月額コスト詳細

| サービス | 計算基準 | 月額コスト |
|---------|----------|-----------|
| **Embeddings (text-embedding-004)** | 90,000クエリ × 50文字 × $0.00025/1K | $1.13 |
| **Gemini 1.5 Pro Input** | 477Mトークン × $0.00125/1K | $596.25 |
| **Gemini 1.5 Pro Output** | 18Mトークン × $0.005/1K | $90.00 |
| **Vector Search インデックス** | 10,000ベクトル × 768次元 | $0.01 |
| **Vector Search クエリ** | 90,000クエリ × $0.60/1K | $54.00 |
| **Cloud Storage** | 4GB + API操作 | $0.125 |
| **Cloud Run** | 125時間 + 90,000リクエスト | $0.04 |

### **パターンA 合計: $741.54/月**
- **テナント当たり:** $7.42/月
- **チャット1回当たり:** $0.008

---

## パターンB: Gemini 2.5 Flash（コスト最適化）

### 月額コスト詳細

| サービス | 計算基準 | 月額コスト |
|---------|----------|-----------|
| **Embeddings (text-embedding-004)** | 90,000クエリ × 50文字 × $0.00025/1K | $1.13 |
| **Gemini 2.5 Flash Input** | 477Mトークン × $0.0003/1K | $143.10 |
| **Gemini 2.5 Flash Output** | 18Mトークン × $0.0025/1K | $45.00 |
| **Vector Search インデックス** | 10,000ベクトル × 768次元 | $0.01 |
| **Vector Search クエリ** | 90,000クエリ × $0.60/1K | $54.00 |
| **Cloud Storage** | 4GB + API操作 | $0.125 |
| **Cloud Run** | 125時間 + 90,000リクエスト | $0.04 |

### **パターンB 合計: $243.39/月**
- **テナント当たり:** $2.43/月
- **チャット1回当たり:** $0.003

---

## コスト比較サマリー

| 項目 | Gemini 1.5 Pro | Gemini 2.5 Flash | 削減効果 |
|-----|----------------|------------------|----------|
| **月額総コスト** | $741.54 | $243.39 | **67%削減** |
| **テナント単価** | $7.42 | $2.43 | **$4.99削減** |
| **チャット単価** | $0.008 | $0.003 | **$0.005削減** |
| **年間削減額** | - | - | **$5,978** |

---

## 性能・品質比較

### Gemini 1.5 Pro
**メリット:**
- 最高レベルの推論能力
- 複雑な質問への高精度回答
- 長文コンテキスト処理に最適化

**デメリット:**
- 高コスト（全体の92.5%を占有）
- 処理時間が若干長い

### Gemini 2.5 Flash
**メリット:**
- 高速処理
- コストパフォーマンス最適
- RAGタスクに十分な品質
- 最新モデル（2025年推奨）

**デメリット:**
- 超高度な推論タスクでは1.5 Proに劣る可能性

---

## ビジネス影響分析

### 収益性への影響

#### パターンA (1.5 Pro)
- **月額サービス料金:** $15/テナント とした場合
- **粗利:** $15 - $7.42 = **$7.58/テナント**
- **粗利率:** 50.5%

#### パターンB (2.5 Flash)
- **月額サービス料金:** $15/テナント とした場合
- **粗利:** $15 - $2.43 = **$12.57/テナント**
- **粗利率:** 83.8%

### スケーラビリティ

| テナント数 | 1.5 Pro月額 | 2.5 Flash月額 | 差額 |
|-----------|-------------|---------------|------|
| 100社 | $741 | $243 | $498 |
| 500社 | $3,708 | $1,217 | $2,491 |
| 1,000社 | $7,415 | $2,434 | $4,981 |

---

## 推奨事項

### 段階的導入アプローチ
1. **初期フェーズ:** Gemini 2.5 Flash でサービス開始
2. **プレミアム層:** 高度な分析が必要な企業向けに1.5 Proオプション
3. **A/Bテスト:** 品質差を定量評価後、最終判断

### 実装における考慮点
- モデル切り替えは設定変更のみで対応可能
- 品質監視ダッシュボードの導入
- テナント別モデル選択機能の検討

---

## 結論

**Gemini 2.5 Flash を推奨**
- 67%のコスト削減効果
- RAGチャットボット用途に十分な品質
- サービスの競争力強化に直結
- 将来のスケーラビリティ確保

初期フェーズでは2.5 Flashで開始し、必要に応じてプレミアムオプションとして1.5 Proを提供する戦略が最適。